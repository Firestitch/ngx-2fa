<form fsForm [submit]="verify" [dirtySubmitButton]="false">
  <h2>2-Step Verification</h2>

  <div class="code-container">
    <ng-container *ngIf="method.type === 'authenticator' else code">
      <fs-2fa-verification-otp class="otp"></fs-2fa-verification-otp>
    </ng-container>

    <ng-template #code>
      <fs-2fa-verification-code
        [method]="method"
        (codeChange)="codeChanged($event)">
      </fs-2fa-verification-code>
    </ng-template>
  </div>

  <div class="additional">
    <mat-checkbox
      name="trust-device"
      [(ngModel)]="trustedDevice">
      Trust this device
    </mat-checkbox>

    <span matSuffix>
    <a mat-button
       type="button"
       color="primary"
       (click)="resend()"
       [disabled]="resendInProgress"
       class="resend-code-btn">
      <ng-container *ngIf="!resendInProgress else sending">
        Resend Code
      </ng-container>
      <ng-template #sending>
        <mat-spinner [diameter]="12"></mat-spinner> Sending
      </ng-template>
    </a>
  </span>
  </div>

  <div class="actions">
    <button mat-raised-button
            color="primary"
            type="submit">
      Verify
    </button>

    <button mat-button type="button" (click)="showVerificationMethods()">
      Try other ways to verify
    </button>

    <button mat-button type="button" (click)="toSignIn()">
      Back to signin
    </button>
  </div>
</form>
