<fs-dialog>
  <h1 mat-dialog-title>2-Step Verification</h1>
  <mat-dialog-content>
    <table>
      <tr *ngIf="verificationMethodTypes[VerificationMethodType.Sms]">
        <td>
          <mat-icon>textsms</mat-icon>
        </td>
        <td>
          <div class="type">
            <span>Text Message</span>
            <span *ngIf="textHasVerificationMethod" class="enabled"></span>
            <app-defaulted *ngIf="defaultSms"></app-defaulted>
          </div>
          <div class="small">
            Verification codes are sent by text message
            <ng-container *ngIf="textHasVerificationMethod">
              to <span class="items">
                <span *ngFor="let item of twoFactorManageService.smsVerificationMethods">{{item.phoneNumber | fsPhone}}</span>
              </span>
            </ng-container>
          </div>
        </td>
        <td>
          <button 
              *ngIf="textHasVerificationMethod; else textMessageManageButton"
              mat-raised-button 
              type="button"
              (click)="textMessageManage()">
              Manage
            </button>
          <ng-template #textMessageManageButton>
            <button               
                mat-raised-button 
                color="primary"
                type="button"
                (click)="textMessageAdd()">
              Turn On
            </button>
          </ng-template>
        </td>
      </tr>
      <tr *ngIf="verificationMethodTypes[VerificationMethodType.Email]">
        <td>
          <mat-icon>email</mat-icon>
        </td>
        <td>
          <div class="type">
            <span>Email</span> 
            <span *ngIf="emailHasVerificationMethod" class="enabled"></span>
            <app-defaulted *ngIf="defaultEmail"></app-defaulted>
          </div>
          <div class="small">
            Verification codes are sent by email
            <ng-container *ngIf="emailHasVerificationMethod">
              to <span class="items">
                <span *ngFor="let item of twoFactorManageService.emailVerificationMethods">{{item.email}}</span>
              </span>
            </ng-container>
          </div>
        </td>
        <td>
          <button 
              *ngIf="emailHasVerificationMethod; else emailMessageManageButton"
              mat-raised-button 
              type="button"
              (click)="emailMessageManage()">
            Manage
          </button>
        <ng-template #emailMessageManageButton>
          <button               
              mat-raised-button 
              color="primary"
              type="button"
              (click)="emailMessageAdd()">
            Turn On
          </button>
        </ng-template>
        </td>
      </tr>
      <tr *ngIf="verificationMethodTypes[VerificationMethodType.App]">
        <td>
          <mat-icon>phone_iphone</mat-icon>
        </td>
        <td>
          <div class="type">
            <span>Authenticator App</span>
            <span *ngIf="appHasVerificationMethod" class="enabled"></span>
            <app-defaulted *ngIf="defaultApp"></app-defaulted>
          </div>
          <div class="small">Verification code is generated by an authenticator app such as Authy or Google Authenticator</div>
        </td>
        <td>
          <button 
              *ngIf="appHasVerificationMethod; else appMessageManageButton"
              mat-raised-button 
              type="button"
              (click)="appRemove()">
            Remove
          </button>
        <ng-template #appMessageManageButton>
          <button               
              mat-raised-button 
              color="primary"
              type="button"
              (click)="appAdd()">
            Turn On
          </button>
        </ng-template>
        </td>
      </tr> 
    </table>      
  </mat-dialog-content>
  <mat-dialog-actions>
    <button
        mat-button
        color="primary"
        type="button"
        [mat-dialog-close]="undefined">
      Close
    </button>
  </mat-dialog-actions>
</fs-dialog>
